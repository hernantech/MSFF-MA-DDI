Device: cuda
Loading DRGATAN...
  1876 drugs, 218,917 pairs, 95 types  (1.1s)
/home/alex/miniconda3/envs/msff-ddi/lib/python3.10/site-packages/sklearn/model_selection/_split.py:811: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(

============================================================
Fold 1/5  (train=175,133  test=43,784)
============================================================
  Ep   1/200  train=0.3655  (fl=0.3622 ar=0.0033)  val=0.0074  lr=1.00e-03  t=15.1s
  Ep   2/200  train=0.0146  (fl=0.0146 ar=0.0000)  val=0.0039  lr=1.00e-03  t=14.8s
  Ep   3/200  train=0.0208  (fl=0.0208 ar=0.0000)  val=0.0035  lr=9.99e-04  t=15.0s
  Ep   4/200  train=0.0053  (fl=0.0053 ar=0.0000)  val=0.0027  lr=9.99e-04  t=16.2s
  Ep   5/200  train=0.0221  (fl=0.0221 ar=0.0000)  val=0.0032  lr=9.98e-04  t=16.7s
  Ep  10/200  train=0.0023  (fl=0.0023 ar=0.0000)  val=0.0019  lr=9.94e-04  t=16.9s
  Ep  20/200  train=0.0024  (fl=0.0024 ar=0.0000)  val=0.0018  lr=9.76e-04  t=16.9s
  Ep  30/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0015  lr=9.46e-04  t=17.2s
  Ep  40/200  train=0.0016  (fl=0.0016 ar=0.0000)  val=0.0015  lr=9.05e-04  t=17.0s
  Ep  50/200  train=0.0106  (fl=0.0106 ar=0.0000)  val=0.0017  lr=8.55e-04  t=17.0s
  Ep  60/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0013  lr=7.96e-04  t=16.8s
  Ep  70/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0015  lr=7.30e-04  t=16.8s
  Ep  80/200  train=0.0076  (fl=0.0076 ar=0.0000)  val=0.0016  lr=6.58e-04  t=16.9s
  Ep  90/200  train=0.0032  (fl=0.0032 ar=0.0000)  val=0.0014  lr=5.82e-04  t=17.0s
  Ep 100/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=5.05e-04  t=16.9s
  Ep 110/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0013  lr=4.28e-04  t=16.9s
  Early stop at epoch 113  (best val loss 0.0011)

  Evaluating on test fold...
  [fold 1] Accuracy         : 0.1192
  [fold 1] Micro-AUROC      : 0.8220
  [fold 1] Micro-AUPR       : 0.0733
  [fold 1] Macro-F1         : 0.2116
  [fold 1] Macro-Precision  : 0.1461
  [fold 1] Macro-Recall     : 0.7718
  [fold 1] Direction Acc    : 0.8687
  [fold 1] Asymmetry Score  : 0.0155
  [fold 1] F1 [dominant]    : 0.0000
  [fold 1] F1 [top-4]       : 0.0315
  [fold 1] F1 [mid-freq]    : 0.2526
  [fold 1] F1 [rare <10]    : 0.0736
  Saved checkpoint: ../results/clifford_runs/fold1_model.pt

============================================================
Fold 2/5  (train=175,133  test=43,784)
============================================================
  Ep   1/200  train=0.3456  (fl=0.3419 ar=0.0037)  val=0.0070  lr=1.00e-03  t=16.7s
  Ep   2/200  train=0.0197  (fl=0.0197 ar=0.0000)  val=0.0041  lr=1.00e-03  t=16.9s
  Ep   3/200  train=0.0218  (fl=0.0218 ar=0.0000)  val=0.0036  lr=9.99e-04  t=17.0s
  Ep   4/200  train=0.0055  (fl=0.0055 ar=0.0000)  val=0.0027  lr=9.99e-04  t=16.9s
  Ep   5/200  train=0.0245  (fl=0.0245 ar=0.0000)  val=0.0067  lr=9.98e-04  t=17.1s
  Ep  10/200  train=0.0038  (fl=0.0038 ar=0.0000)  val=0.0021  lr=9.94e-04  t=17.1s
  Ep  20/200  train=0.0017  (fl=0.0017 ar=0.0000)  val=0.0017  lr=9.76e-04  t=17.1s
  Ep  30/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0015  lr=9.46e-04  t=17.2s
  Ep  40/200  train=0.0015  (fl=0.0015 ar=0.0000)  val=0.0015  lr=9.05e-04  t=17.2s
  Ep  50/200  train=0.0019  (fl=0.0019 ar=0.0000)  val=0.0015  lr=8.55e-04  t=17.0s
  Ep  60/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0013  lr=7.96e-04  t=17.1s
  Ep  70/200  train=0.0051  (fl=0.0051 ar=0.0000)  val=0.0016  lr=7.30e-04  t=17.1s
  Ep  80/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=6.58e-04  t=17.1s
  Ep  90/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0012  lr=5.82e-04  t=17.2s
  Ep 100/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=5.05e-04  t=17.1s
  Ep 110/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0011  lr=4.28e-04  t=17.1s
  Ep 120/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0013  lr=3.52e-04  t=17.0s
  Ep 130/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0011  lr=2.80e-04  t=17.0s
  Ep 140/200  train=0.0008  (fl=0.0008 ar=0.0000)  val=0.0010  lr=2.14e-04  t=17.1s
  Ep 150/200  train=0.0008  (fl=0.0008 ar=0.0000)  val=0.0010  lr=1.55e-04  t=17.1s
  Ep 160/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0010  lr=1.05e-04  t=17.0s
  Ep 170/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=6.40e-05  t=17.0s
  Ep 180/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=3.42e-05  t=17.1s
  Ep 190/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=1.61e-05  t=17.0s
  Ep 200/200  train=0.0006  (fl=0.0006 ar=0.0000)  val=0.0009  lr=1.00e-05  t=17.1s

  Evaluating on test fold...
  [fold 2] Accuracy         : 0.1504
  [fold 2] Micro-AUROC      : 0.8362
  [fold 2] Micro-AUPR       : 0.0948
  [fold 2] Macro-F1         : 0.2259
  [fold 2] Macro-Precision  : 0.1628
  [fold 2] Macro-Recall     : 0.8301
  [fold 2] Direction Acc    : 0.8494
  [fold 2] Asymmetry Score  : 0.0158
  [fold 2] F1 [dominant]    : 0.0000
  [fold 2] F1 [top-4]       : 0.0839
  [fold 2] F1 [mid-freq]    : 0.2837
  [fold 2] F1 [rare <10]    : 0.0284
  Saved checkpoint: ../results/clifford_runs/fold2_model.pt

============================================================
Fold 3/5  (train=175,134  test=43,783)
============================================================
  Ep   1/200  train=0.3635  (fl=0.3596 ar=0.0039)  val=0.0061  lr=1.00e-03  t=17.0s
  Ep   2/200  train=0.0293  (fl=0.0293 ar=0.0000)  val=0.0057  lr=1.00e-03  t=17.0s
  Ep   3/200  train=0.0089  (fl=0.0089 ar=0.0000)  val=0.0030  lr=9.99e-04  t=17.2s
  Ep   4/200  train=0.0044  (fl=0.0044 ar=0.0000)  val=0.0024  lr=9.99e-04  t=17.0s
  Ep   5/200  train=0.0313  (fl=0.0313 ar=0.0000)  val=0.0032  lr=9.98e-04  t=17.1s
  Ep  10/200  train=0.0118  (fl=0.0118 ar=0.0000)  val=0.0041  lr=9.94e-04  t=17.2s
  Ep  20/200  train=0.0021  (fl=0.0021 ar=0.0000)  val=0.0018  lr=9.76e-04  t=17.2s
  Ep  30/200  train=0.0018  (fl=0.0018 ar=0.0000)  val=0.0016  lr=9.46e-04  t=17.1s
  Ep  40/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0015  lr=9.05e-04  t=17.2s
  Ep  50/200  train=0.0015  (fl=0.0015 ar=0.0000)  val=0.0015  lr=8.55e-04  t=17.1s
  Ep  60/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0013  lr=7.96e-04  t=17.1s
  Ep  70/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0014  lr=7.30e-04  t=17.0s
  Ep  80/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0013  lr=6.58e-04  t=17.1s
  Ep  90/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0012  lr=5.82e-04  t=17.1s
  Ep 100/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0013  lr=5.05e-04  t=17.1s
  Ep 110/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=4.28e-04  t=17.1s
  Ep 120/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0011  lr=3.52e-04  t=17.1s
  Ep 130/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0013  lr=2.80e-04  t=17.1s
  Ep 140/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0010  lr=2.14e-04  t=17.0s
  Ep 150/200  train=0.0008  (fl=0.0008 ar=0.0000)  val=0.0010  lr=1.55e-04  t=17.0s
  Ep 160/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0010  lr=1.05e-04  t=17.0s
  Ep 170/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=6.40e-05  t=17.0s
  Ep 180/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=3.42e-05  t=16.9s
  Ep 190/200  train=0.0006  (fl=0.0006 ar=0.0000)  val=0.0009  lr=1.61e-05  t=16.9s
  Ep 200/200  train=0.0006  (fl=0.0006 ar=0.0000)  val=0.0008  lr=1.00e-05  t=16.9s

  Evaluating on test fold...
  [fold 3] Accuracy         : 0.1624
  [fold 3] Micro-AUROC      : 0.8378
  [fold 3] Micro-AUPR       : 0.1037
  [fold 3] Macro-F1         : 0.2316
  [fold 3] Macro-Precision  : 0.1693
  [fold 3] Macro-Recall     : 0.8394
  [fold 3] Direction Acc    : 0.8521
  [fold 3] Asymmetry Score  : 0.0158
  [fold 3] F1 [dominant]    : 0.0000
  [fold 3] F1 [top-4]       : 0.1346
  [fold 3] F1 [mid-freq]    : 0.2624
  [fold 3] F1 [rare <10]    : 0.0622
  Saved checkpoint: ../results/clifford_runs/fold3_model.pt

============================================================
Fold 4/5  (train=175,134  test=43,783)
============================================================
  Ep   1/200  train=0.3688  (fl=0.3652 ar=0.0036)  val=0.0078  lr=1.00e-03  t=16.8s
  Ep   2/200  train=0.0182  (fl=0.0182 ar=0.0000)  val=0.0041  lr=1.00e-03  t=17.0s
  Ep   3/200  train=0.0209  (fl=0.0209 ar=0.0000)  val=0.0044  lr=9.99e-04  t=16.9s
  Ep   4/200  train=0.0068  (fl=0.0068 ar=0.0000)  val=0.0029  lr=9.99e-04  t=17.2s
  Ep   5/200  train=0.0039  (fl=0.0039 ar=0.0000)  val=0.0023  lr=9.98e-04  t=17.0s
  Ep  10/200  train=0.0033  (fl=0.0033 ar=0.0000)  val=0.0020  lr=9.94e-04  t=17.4s
  Ep  20/200  train=0.0031  (fl=0.0031 ar=0.0000)  val=0.0019  lr=9.76e-04  t=17.0s
  Ep  30/200  train=0.0186  (fl=0.0186 ar=0.0000)  val=0.0022  lr=9.46e-04  t=17.4s
  Ep  40/200  train=0.0119  (fl=0.0119 ar=0.0000)  val=0.0020  lr=9.05e-04  t=17.0s
  Ep  50/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0015  lr=8.55e-04  t=16.9s
  Ep  60/200  train=0.0099  (fl=0.0099 ar=0.0000)  val=0.0018  lr=7.96e-04  t=16.7s
  Ep  70/200  train=0.0091  (fl=0.0091 ar=0.0000)  val=0.0019  lr=7.30e-04  t=16.8s
  Ep  80/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0014  lr=6.58e-04  t=16.6s
  Ep  90/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0013  lr=5.82e-04  t=16.6s
  Ep 100/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0012  lr=5.05e-04  t=16.8s
  Ep 110/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0011  lr=4.28e-04  t=16.7s
  Ep 120/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0012  lr=3.52e-04  t=16.7s
  Ep 130/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0011  lr=2.80e-04  t=16.8s
  Ep 140/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0013  lr=2.14e-04  t=16.7s
  Ep 150/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0011  lr=1.55e-04  t=16.6s
  Ep 160/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0010  lr=1.05e-04  t=16.7s
  Ep 170/200  train=0.0008  (fl=0.0008 ar=0.0000)  val=0.0010  lr=6.40e-05  t=16.6s
  Ep 180/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0010  lr=3.42e-05  t=16.6s
  Ep 190/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=1.61e-05  t=16.6s
  Ep 200/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0010  lr=1.00e-05  t=16.6s

  Evaluating on test fold...
  [fold 4] Accuracy         : 0.1377
  [fold 4] Micro-AUROC      : 0.8491
  [fold 4] Micro-AUPR       : 0.0889
  [fold 4] Macro-F1         : 0.2063
  [fold 4] Macro-Precision  : 0.1470
  [fold 4] Macro-Recall     : 0.8099
  [fold 4] Direction Acc    : 0.8599
  [fold 4] Asymmetry Score  : 0.0155
  [fold 4] F1 [dominant]    : 0.0000
  [fold 4] F1 [top-4]       : 0.0575
  [fold 4] F1 [mid-freq]    : 0.2450
  [fold 4] F1 [rare <10]    : 0.0501
  Saved checkpoint: ../results/clifford_runs/fold4_model.pt

============================================================
Fold 5/5  (train=175,134  test=43,783)
============================================================
  Ep   1/200  train=0.3662  (fl=0.3619 ar=0.0044)  val=0.0080  lr=1.00e-03  t=17.0s
  Ep   2/200  train=0.0197  (fl=0.0197 ar=0.0000)  val=0.0039  lr=1.00e-03  t=16.7s
  Ep   3/200  train=0.0058  (fl=0.0058 ar=0.0000)  val=0.0028  lr=9.99e-04  t=17.0s
  Ep   4/200  train=0.0249  (fl=0.0249 ar=0.0000)  val=0.0031  lr=9.99e-04  t=17.0s
  Ep   5/200  train=0.0044  (fl=0.0044 ar=0.0000)  val=0.0023  lr=9.98e-04  t=16.8s
  Ep  10/200  train=0.0026  (fl=0.0026 ar=0.0000)  val=0.0022  lr=9.94e-04  t=17.1s
  Ep  20/200  train=0.0019  (fl=0.0019 ar=0.0000)  val=0.0016  lr=9.76e-04  t=16.9s
  Ep  30/200  train=0.0018  (fl=0.0018 ar=0.0000)  val=0.0015  lr=9.46e-04  t=17.1s
  Ep  40/200  train=0.0015  (fl=0.0015 ar=0.0000)  val=0.0015  lr=9.05e-04  t=16.9s
  Ep  50/200  train=0.0015  (fl=0.0015 ar=0.0000)  val=0.0015  lr=8.55e-04  t=17.1s
  Ep  60/200  train=0.0014  (fl=0.0014 ar=0.0000)  val=0.0019  lr=7.96e-04  t=16.7s
  Ep  70/200  train=0.0090  (fl=0.0090 ar=0.0000)  val=0.0018  lr=7.30e-04  t=16.7s
  Ep  80/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0014  lr=6.58e-04  t=16.7s
  Ep  90/200  train=0.0012  (fl=0.0012 ar=0.0000)  val=0.0013  lr=5.82e-04  t=16.7s
  Ep 100/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0013  lr=5.05e-04  t=16.7s
  Ep 110/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=4.28e-04  t=16.7s
  Ep 120/200  train=0.0013  (fl=0.0013 ar=0.0000)  val=0.0012  lr=3.52e-04  t=16.7s
  Ep 130/200  train=0.0010  (fl=0.0010 ar=0.0000)  val=0.0012  lr=2.80e-04  t=16.7s
  Ep 140/200  train=0.0011  (fl=0.0011 ar=0.0000)  val=0.0011  lr=2.14e-04  t=16.7s
  Ep 150/200  train=0.0009  (fl=0.0009 ar=0.0000)  val=0.0010  lr=1.55e-04  t=16.7s
  Ep 160/200  train=0.0008  (fl=0.0008 ar=0.0000)  val=0.0010  lr=1.05e-04  t=16.7s
  Ep 170/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0010  lr=6.40e-05  t=16.7s
  Ep 180/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=3.42e-05  t=16.7s
  Ep 190/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=1.61e-05  t=16.7s
  Ep 200/200  train=0.0007  (fl=0.0007 ar=0.0000)  val=0.0009  lr=1.00e-05  t=16.6s

  Evaluating on test fold...
  [fold 5] Accuracy         : 0.1515
  [fold 5] Micro-AUROC      : 0.8412
  [fold 5] Micro-AUPR       : 0.0920
  [fold 5] Macro-F1         : 0.2217
  [fold 5] Macro-Precision  : 0.1604
  [fold 5] Macro-Recall     : 0.8072
  [fold 5] Direction Acc    : 0.8508
  [fold 5] Asymmetry Score  : 0.0156
  [fold 5] F1 [dominant]    : 0.0000
  [fold 5] F1 [top-4]       : 0.0834
  [fold 5] F1 [mid-freq]    : 0.2562
  [fold 5] F1 [rare <10]    : 0.0492
  Saved checkpoint: ../results/clifford_runs/fold5_model.pt

============================================================
5-FOLD CROSS-VALIDATION SUMMARY
============================================================
  accuracy              : 0.1443 ± 0.0148
  auroc                 : 0.8373 ± 0.0088
  aupr                  : 0.0906 ± 0.0099
  f1                    : 0.2194 ± 0.0093
  precision             : 0.1571 ± 0.0091
  recall                : 0.8117 ± 0.0233
  direction_accuracy    : 0.8562 ± 0.0072
  asymmetry_score       : 0.0157 ± 0.0002
  f1_dominant           : 0.0000 ± 0.0000
  f1_top4               : 0.0782 ± 0.0342
  f1_mid                : 0.2600 ± 0.0131
  f1_rare               : 0.0527 ± 0.0151

Summary saved to ../results/clifford_runs/cv_summary.csv
